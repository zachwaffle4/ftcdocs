<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
 <meta name="google-site-verification" content="75RBwHq1pWFvK2E7wuVgAeq_LOOJrU4q1wRIjXqPpqg" />  <!-- Google Analytics Intentionally Disabled -->  <!-- Cookie Banner Intentionally Disabled --> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Color Processing Color Sensor &mdash; FIRST Tech Challenge Docs 0.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.custom.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster.bundle.min.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-shadow.min.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-punk.min.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-noir.min.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-light.min.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/tooltipster-sideTip-borderless.min.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/micromodal.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/ftc-rtd.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/sphinx_rtd_theme.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/dark_mode_css/general.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/dark_mode_css/dark.css" />

  
    <link rel="shortcut icon" href="../../_static/FIRSTicon_RGB_withTM.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/js/hoverxref.js"></script>
        <script src="../../_static/js/tooltipster.bundle.min.js"></script>
        <script src="../../_static/js/micromodal.min.js"></script>
        <script src="../../_static/js/external-links-new-tab.js"></script>
        <script src="../../_static/js/adjust-css-vars.js"></script>
        <script src="../../_static/design-tabs.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../../_static/dark_mode_js/default_light.js"></script>
        <script src="../../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Color Blob Concepts" href="../color-blob-concepts/color-blob-concepts.html" />
    <link rel="prev" title="Color Processing Introduction" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 


<div class="header-bar">
        <!-- Color Strip -->
        <div class="color-strip">
            <div class="fred"></div>
            <div class="forange"></div>
            <div class="fblue"></div>
        </div>
        <div class="link-bar-container">
            <div id="link-bar" class="collapse">
                <ul>          
			<li id="ftc-page-link"><a href="https://www.firstinspires.org/resource-library/ftc/game-and-season-info" target="_blank"><i>FIRST</i> Official Team Resources</a></li>
                  <li id="qa-link"><a href="https://ftc-qa.firstinspires.org/" target="_blank">Official Game Q&A</a></li>
                </ul>
            </div>
        </div>
</div>

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            FIRST Tech Challenge Docs
              <img src="../../_static/FIRSTTech_iconHorz_RGB_reverse.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.3.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/ftcoverview.html">About the <em>FIRST</em> Tech Challenge</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gracious_professionalism/gp.html"><em>Gracious Professionalism®</em></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../persona_pages/rookie_teams/rookie_teams.html">New Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../persona_pages/veteran_teams/veteran_teams.html">Returning Teams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../persona_pages/coach_admin/coach_admin.html">Coach (Administrative) Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../persona_pages/mentor_tech/mentor_tech.html">Technical Mentor Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Game and Season-Specific Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../game_specific_resources/blog/blog.html"><em>FIRST</em> Tech Challenge Blog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tech_tips/tech-tips.html"><em>FIRST</em> Tech Challenge Tech Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ai/innovation_corner/innovation-corner.html">AI Innovation Corner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../manuals/game_manuals/game_manuals.html">Competition Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../game_specific_resources/ftcqa/ftcqa.html">Game Q&amp;A System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../game_specific_resources/playing_field_resources/playing_field_resources.html">Playing Field Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../game_specific_resources/field_coordinate_system/field-coordinate-system.html">Field Coordinate System</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Development Kit (SDK)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../programming_resources/laptops/laptops.html">Laptop Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ftc_sdk/overview/index.html">SDK Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ftc_sdk/updating/index.html">Updating Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Control System Resources</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../programming_resources/shared/control_system_intro/The-FTC-Control-System.html">Control System Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../control_hard_compon/index.html">Hardware Component Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware_and_software_configuration/index.html">Hardware and Software Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware_and_software_configuration/self_inspect/new-self-inspect.html"><em>FIRST</em> Tech Challenge Self-Inspect</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware_and_software_configuration/self_inspect/self-inspect.html">Old Self-Inspect</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../programming_resources/index.html">Programming Resources</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../programming_resources/index.html#programming-tutorials">Programming Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programming_resources/index.html#supporting-documentation">Supporting Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programming_resources/index.html#apriltag-programming">AprilTag Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programming_resources/index.html#tensorflow-programming">TensorFlow Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programming_resources/index.html#vision-programming">Vision Programming</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../programming_resources/index.html#camera-color-processing">Camera Color Processing</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html">Color Processing Introduction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Color Processing Color Sensor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sample-opmode">Sample OpMode</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#opening-the-sample-opmode">Opening the Sample OpMode</a></li>
<li class="toctree-l5"><a class="reference internal" href="#running-the-sample-opmode">Running the Sample OpMode</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#ds-preview">DS Preview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rc-preview">RC Preview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modify-the-sample">Modify the Sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-the-visionportal">Building the VisionPortal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#testing-the-result">Testing the Result</a></li>
<li class="toctree-l4"><a class="reference internal" href="#opmode-programming">OpMode Programming</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advanced-use">Advanced Use</a></li>
<li class="toctree-l4"><a class="reference internal" href="#next-sections">Next Sections</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../color-blob-concepts/color-blob-concepts.html">Color Blob Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../color-locator-discover/color-locator-discover.html">Color Locator (Discover)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../color-locator-explore/color-locator-explore.html">Color Locator (Explore)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../color-locator-challenge/color-locator-challenge.html">Color Locator (Challenge)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../color-locator-round-blobs/color-locator-round-blobs.html">Color Locator (Round Blobs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../color-spaces/color-spaces.html">Color Spaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../programming_resources/index.html#advanced-topics">Advanced Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programming_resources/index.html#java-tutorials">Java Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../programming_resources/index.html#additional-first-website-resources">Additional <em>FIRST</em> Website Resources</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Programming Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../programming_resources/shared/choosing_program_lang/choosing-program-lang.html">Choosing a Programming Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programming_resources/blocks/Blocks-Tutorial.html">Blocks Programming Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programming_resources/onbot_java/OnBot-Java-Tutorial.html">OnBot Java Programming Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../programming_resources/android_studio_java/Android-Studio-Tutorial.html">Android Studio Programming Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AprilTag Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../apriltag/vision_portal/apriltag_intro/apriltag-intro.html">AprilTag Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apriltag/vision_portal/visionportal_overview/visionportal-overview.html">VisionPortal Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apriltag/vision_portal/visionportal_webcams/visionportal-webcams.html">Webcams for VisionPortal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apriltag/understanding_apriltag_detection_values/understanding-apriltag-detection-values.html">Understanding AprilTag Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apriltag/vision_portal/apriltag_localization/apriltag-localization.html">AprilTag Localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../apriltag/opmode_test_images/opmode-test-images.html">AprilTag Test Images</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CAD Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cad_resources/index.html">Computer Aided Design (CAD)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Electrostatic Discharge</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hardware_and_software_configuration/configuring/managing_esd/managing-esd.html">Managing ESD Effects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Manufacturing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../manufacturing/index.html">Manufacturing Methods</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Team Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/faqs.html">Common Team FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sponsors/software/software.html">Team Complimentary Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sponsors/discounts/discounts.html">Team Discounts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FTC Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../booklets/index.html">Booklets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ftc-docs.firstinspires.org/projects/ftcdocs-archive/en/latest/index.html">Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ftc_docs/form/form.html">Site Feedback Form</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contrib/index.html">Contributing to FTC Docs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">FIRST Tech Challenge Docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../programming_resources/index.html">Programming Resources</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Color Processing Introduction</a></li>
      <li class="breadcrumb-item active">Color Processing Color Sensor</li>
<li class="wy-breadcrumbs-aside" style="padding-inline-start: 6px;">
</li>

      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/color_processing/color-sensor/color-sensor.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="color-processing-color-sensor">
<h1>Color Processing Color Sensor<a class="headerlink" href="#color-processing-color-sensor" title="Permalink to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>A simple way to use FTC’s new OpenCV vision tools is to operate a “Color
Sensor”.  Namely, it can determine <strong>the color seen by the robot’s camera</strong>,
in a specified zone.</p>
<p>Below, the small central rectangle is the region being evaluated:</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../../_images/10-sensor-intro.png"><img alt="INTO THE DEEP game pieces" src="../../_images/10-sensor-intro.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Color sensor detection zone</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>A key benefit is that the camera can be much further away from the object than,
for example, a REV Color Sensor or others like it.</p>
<p>It’s still important to accurately point the camera and carefully select the
image zone to inspect.</p>
<p>For the above example, OpenCV can provide results like this:</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/20-telemetry-intro.png"><img alt="Driver Station App showing RED detection" src="../../_images/20-telemetry-intro.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">RED Detection using Color Sensor</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The following sections describe how to do this, with a Sample OpMode.</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p><em>Skip this section if …</em></p>
<ul class="simple">
<li><p><em>the active robot configuration already contains “Webcam 1”</em>, or</p></li>
<li><p><em>using the built-in camera of an Android phone as Robot Controller.</em></p></li>
</ul>
<p>Before starting the programming, REV Control Hub users should make a robot
configuration that includes the USB webcam to be used as a color sensor.</p>
<p>For now, use the default webcam name, “Webcam 1”.  If a different name is
preferred, edit the Sample OpMode to agree with the exact webcam name in the
robot configuration.</p>
<p>Save and activate that configuration; its name should appear on the paired
Driver Station screen.</p>
</section>
<section id="sample-opmode">
<h2>Sample OpMode<a class="headerlink" href="#sample-opmode" title="Permalink to this heading"></a></h2>
<section id="opening-the-sample-opmode">
<h3>Opening the Sample OpMode<a class="headerlink" href="#opening-the-sample-opmode" title="Permalink to this heading"></a></h3>
<p>To learn about opening the Sample OpMode, click the tab for Blocks or Java:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="41193c58-4242-443d-812e-df04906d4cfd" name="f9c910c7-f243-4eec-a6cc-c901e136a92c" type="radio">
</input><label class="sd-tab-label" data-sync-id="blocks" for="41193c58-4242-443d-812e-df04906d4cfd">
Blocks</label><div class="sd-tab-content docutils">
<ol class="arabic simple">
<li><p>On a laptop or desktop computer connected via Wi-Fi to the Robot
Controller, open the Chrome browser.  Go to the REV Control
Hub’s address <code class="docutils literal notranslate"><span class="pre">http://192.168.43.1:8080</span></code> (or
<code class="docutils literal notranslate"><span class="pre">http://192.168.49.1:8080</span></code> for Android RC phone) and click the
<em>Blocks</em> tab.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">New</span> <span class="pre">OpMode</span></code>, enter a new name such as
“ColorSensor_Maria_v01”, and select the Sample OpMode
<code class="docutils literal notranslate"><span class="pre">ConceptVisionColorSensor</span></code>.</p></li>
<li><p>At the top of the Blocks screen, you can change the type from “TeleOp” to
“Autonomous”, since this Sample OpMode does not use gamepads.</p></li>
<li><p>If using the built-in camera of an RC phone, drag out the relevant Block
from the left-side <code class="docutils literal notranslate"><span class="pre">VisionPortal.Builder</span></code> toolbox.</p></li>
<li><p>Save the OpMode, time to try it!</p></li>
</ol>
</div>
<input id="58a58cb3-339b-4027-bcb0-30f5089c66f0" name="f9c910c7-f243-4eec-a6cc-c901e136a92c" type="radio">
</input><label class="sd-tab-label" data-sync-id="java" for="58a58cb3-339b-4027-bcb0-30f5089c66f0">
Java</label><div class="sd-tab-content docutils">
<ol class="arabic simple">
<li><p>Open your choice of OnBot Java or Android Studio.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">teamcode</span></code> folder, add/create a new OpMode with a name such as
“ColorSensor_Bobby_v01.java”, and select the Sample OpMode
<code class="docutils literal notranslate"><span class="pre">ConceptVisionColorSensor.java</span></code>.</p></li>
<li><p>At about Line 58, you can change <code class="docutils literal notranslate"><span class="pre">&#64;TeleOp</span></code> to <code class="docutils literal notranslate"><span class="pre">&#64;Autonomous</span></code>, since
this Sample OpMode does not use gamepads.</p></li>
<li><p>If using the built-in camera of an RC phone, follow the OpMode comments
to specify that camera.</p></li>
<li><p>Click “Build”, time to try it!</p></li>
</ol>
</div>
</div>
</section>
<section id="running-the-sample-opmode">
<h3>Running the Sample OpMode<a class="headerlink" href="#running-the-sample-opmode" title="Permalink to this heading"></a></h3>
<p>On the Driver Station:</p>
<ol class="arabic simple">
<li><p>Select the Autonomous OpMode that you just saved or built.</p></li>
<li><p>Turn off the automatic 30-second match timer (green slider).</p></li>
<li><p>Touch INIT only.</p></li>
</ol>
<p>The OpMode should give Telemetry, stating the main “matched” color inside the Region of Interest.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../../_images/30-DStelemetry.png"><img alt="Driver Station Telemetry" src="../../_images/30-DStelemetry.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Driver Station Telemetry</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Move the camera around, and watch the Telemetry area on the Driver Station
screen.  It should state “BLUE” when pointing at a blue object, and likewise
should identify other common colors.</p>
<p><strong>It’s working!</strong>  You have a color sensor in your robot camera.  Think about
how to use this in the FTC Robot Game.</p>
<p><em>Skip the next two sections if you already know how to use FTC previews.</em></p>
</section>
</section>
<section id="ds-preview">
<h2>DS Preview<a class="headerlink" href="#ds-preview" title="Permalink to this heading"></a></h2>
<p>Before describing how to modify the OpMode, this page offers two sections
showing how to view the OpenCV results with <strong>previews</strong>.  Previewing is
essential for working with vision code.</p>
<p><strong>Opening the DS Preview</strong></p>
<ol class="arabic simple">
<li><p>On the Driver Station (DS), remain in INIT – don’t touch the Start button.</p></li>
<li><p>At the top right corner, touch the 3-dots menu, then <code class="docutils literal notranslate"><span class="pre">Camera</span> <span class="pre">Stream</span></code>.
This shows the camera’s view; tap the image to refresh it.</p></li>
</ol>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../../_images/34-CameraStream.png"><img alt="Camera Stream Preview" src="../../_images/34-CameraStream.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Camera Stream Preview</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Drawn on the image is the rectangle being evaluated, called the <strong>Region of
Interest</strong> (ROI).  The ROI border color is the rectangle’s predominant color,
reported to DS Telemetry.</p>
<p>If that border “disappears” against a solid-color background, the thin white
cross-hairs and 4 small white dots can still identify the ROI.</p>
<p>For a BIG preview, touch the arrows at the bottom right corner.</p>
<p>Or, select Camera Stream again, to return to the previous screen and its
Telemetry.</p>
</section>
<section id="rc-preview">
<h2>RC Preview<a class="headerlink" href="#rc-preview" title="Permalink to this heading"></a></h2>
<p>The Robot Controller (RC) device also makes a preview, called <code class="docutils literal notranslate"><span class="pre">LiveView</span></code>.
This is full video, and is shown automatically on the screen of an RC phone.</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../../_images/38-LiveView.png"><img alt="Control Hub LiveView" src="../../_images/38-LiveView.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Control Hub LiveView</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The above preview is from a REV Control Hub.</p>
<p>It has no physical screen, so you must plug in an HDMI monitor <strong>or</strong> use
open-source <a class="reference external" href="https://github.com/Genymobile/scrcpy">scrcpy</a> (called “screen
copy”) to see the preview on a laptop or computer that’s connected via Wi-Fi to
the Control Hub.</p>
</section>
<section id="modify-the-sample">
<h2>Modify the Sample<a class="headerlink" href="#modify-the-sample" title="Permalink to this heading"></a></h2>
<p>This Sample OpMode is designed for the user to select/edit <strong>two inputs</strong>:</p>
<ul class="simple">
<li><p>define the Region of Interest (ROI)</p></li>
<li><p>list the colors that might be found</p></li>
</ul>
<p>For the <strong>first input</strong>, there are 3 ways to define the ROI:</p>
<ul class="simple">
<li><p>entire frame</p></li>
<li><p>sub-region, defined with standard image coordinates</p></li>
<li><p>sub-region, defined with a normalized +/- 1.0 coordinate system</p></li>
</ul>
<p>For the <strong>second input</strong>, you must list the candidate colors from which a
result will be selected as a “Match”.</p>
<p>Simply choose from the 10 “Swatches”: RED, ORANGE, YELLOW, GREEN, CYAN, BLUE,
PURPLE, MAGENTA, BLACK, WHITE.  For efficiency, add only those Swatches for
which you reasonably expect to get a match.</p>
<p><strong>The Blocks and Java OpModes contain detailed comments to guide you through
these edits.</strong>  They are not repeated in this tutorial.</p>
</section>
<section id="building-the-visionportal">
<h2>Building the VisionPortal<a class="headerlink" href="#building-the-visionportal" title="Permalink to this heading"></a></h2>
<p>The Sample OpMode first creates a “Predominant Color” <strong>Processor</strong> using the
<strong>Builder</strong> pattern.  This is the same Builder pattern used to create an
AprilTag Processor, and previously a TensorFlow Processor.</p>
<p>The Sample OpMode then creates a <strong>VisionPortal</strong>, again using a Builder
pattern.  This includes adding the “Predominant Color” Processor to the
VisionPortal.</p>
<p>How does OpenCV determine the “predominant color” of the ROI?  An algorithm
called <a class="reference external" href="https://en.wikipedia.org/wiki/K-means_clustering">“k-means”</a>
determines clusters of similar colors.  The color of the cluster with the most
pixels is called “predominant” here. <em>(This will NOT be on the final.)</em></p>
</section>
<section id="testing-the-result">
<h2>Testing the Result<a class="headerlink" href="#testing-the-result" title="Permalink to this heading"></a></h2>
<p>After trying and learning how the commands work, you can incorporate this Color
Sensor into your Autonomous and/or TeleOp OpModes.</p>
<p>As seen in the OpMode’s Telemetry section, the result is called
<code class="docutils literal notranslate"><span class="pre">closestSwatch</span></code> and appears as a word (RED, BLUE, etc.).  But this is not
plain text!</p>
<p><strong>Testing</strong>, or comparing, for a particular color-match must be done as
follows.  Select and read the Blocks <strong>or</strong> Java section below:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="57e7e6ea-db02-4328-95a4-5ecc930aee4f" name="2a77033e-d864-4771-90ad-611b45cf2f39" type="radio">
</input><label class="sd-tab-label" data-sync-id="blocks" for="57e7e6ea-db02-4328-95a4-5ecc930aee4f">
Blocks</label><div class="sd-tab-content docutils">
<p>At the left side, pull out the following multi-Block from <code class="docutils literal notranslate"><span class="pre">Vision/PredominantColor/Processor</span></code>:</p>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="../../_images/50-closestSwatchCompare.png"><img alt="Closest Swatch Comparison" src="../../_images/50-closestSwatchCompare.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Closest Swatch Comparison</span><a class="headerlink" href="#id6" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>You must use this special Block to determine if the result is (for example) RED.</p>
<p>Why?  The result, called <code class="docutils literal notranslate"><span class="pre">closestSwatch</span></code> is not <strong>text</strong> (yes it seems
like text!).  It’s a type called <code class="docutils literal notranslate"><span class="pre">Swatch</span></code> and can be compared only to
another <code class="docutils literal notranslate"><span class="pre">Swatch</span></code>.</p>
</div>
<input id="9942c0b6-9a61-4207-a1f3-f7ba47707b8a" name="2a77033e-d864-4771-90ad-611b45cf2f39" type="radio">
</input><label class="sd-tab-label" data-sync-id="java" for="9942c0b6-9a61-4207-a1f3-f7ba47707b8a">
Java</label><div class="sd-tab-content docutils">
<p>In the sample OpMode, here’s the Telemetry that gives the result:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">telemetry</span><span class="p">.</span><span class="na">addData</span><span class="p">(</span><span class="s">&quot;Best Match:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="na">closestSwatch</span><span class="p">);</span>
</pre></div>
</div>
<p>This displays as text, but this is <strong>not</strong> Java type <code class="docutils literal notranslate"><span class="pre">String</span></code>!</p>
<p>Here’s how to determine if the result is (for example) RED:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">closestSwatch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Swatch</span><span class="p">.</span><span class="na">RED</span><span class="p">)</span><span class="w">   </span><span class="p">{</span><span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<p>Why?  The result, called <code class="docutils literal notranslate"><span class="pre">closestSwatch</span></code> is of type <code class="docutils literal notranslate"><span class="pre">Swatch</span></code> and can
be compared only to another <code class="docutils literal notranslate"><span class="pre">Swatch</span></code>.</p>
</div>
</div>
</section>
<section id="opmode-programming">
<h2>OpMode Programming<a class="headerlink" href="#opmode-programming" title="Permalink to this heading"></a></h2>
<p>The Color Sensor part of your team’s Autonomous OpMode might include these
goals:</p>
<ol class="arabic simple">
<li><p>Seek a color, using the code from this Sample OpMode</p></li>
<li><p>Take a robot action, based on finding that color</p></li>
</ol>
<p>If so, select and read the Blocks <strong>or</strong> Java section below:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="30379842-0d00-464f-bc8f-d33aaf1c5cd4" name="f0fdecfc-27d2-4655-8b2c-d563334db8d9" type="radio">
</input><label class="sd-tab-label" data-sync-id="blocks" for="30379842-0d00-464f-bc8f-d33aaf1c5cd4">
Blocks</label><div class="sd-tab-content docutils">
<p>Beginners often try this first:</p>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../../_images/55-IFclosestSwatchWrongWay.png"><img alt="Wrong way to act upon match result" src="../../_images/55-IFclosestSwatchWrongWay.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Wrong way to act upon match result</span><a class="headerlink" href="#id7" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The problem is, after the robot does the action for RED, the OpMode is
still inside the vision loop.  Very messy and unpredictable.</p>
<p>A better approach is to save the result (as text!), exit the loop, then
retrieve the stored result to take the desired RED action.</p>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="../../_images/58-IFclosestSwatchRightWay.png"><img alt="Right way to act upon match result" src="../../_images/58-IFclosestSwatchRightWay.png" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-text">Right way to act upon match result</span><a class="headerlink" href="#id8" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>How to exit the vision loop?  It could be based on <a class="reference external" href="https://github.com/FIRST-Tech-Challenge/FtcRobotController/wiki/Timers-in-FTC-Blocks">time</a>
, or finding a particular color, or finding a particular color 10 times
in a row, or finding only a particular color for 1 full second, or any
other desired criteria.</p>
</div>
<input id="39b6a247-ad35-487a-a60f-5547b7c87bfc" name="f0fdecfc-27d2-4655-8b2c-d563334db8d9" type="radio">
</input><label class="sd-tab-label" data-sync-id="java" for="39b6a247-ad35-487a-a60f-5547b7c87bfc">
Java</label><div class="sd-tab-content docutils">
<p>The color result is generated inside a vision loop.  Save the result (as
text!), exit the loop, then retrieve the stored result to take the
desired RED action.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">String</span><span class="w"> </span><span class="n">savedColorMatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;NULL&quot;</span><span class="p">;</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">closestSwatch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Swatch</span><span class="p">.</span><span class="na">RED</span><span class="p">)</span><span class="w">     </span><span class="p">{</span>
<span class="w">     </span><span class="n">savedColorMatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RED&quot;</span><span class="p">;</span>
<span class="w">     </span><span class="c1">// your code here: optional to exit the vision loop based on your criteria</span>
<span class="w">     </span><span class="p">}</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="c1">// After exiting the vision loop...</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">savedColorMatch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;RED&quot;</span><span class="p">)</span><span class="w">     </span><span class="p">{</span>
<span class="w">     </span><span class="c1">// your code here: robot actions if the ROI was RED</span>
<span class="w">     </span><span class="p">}</span>
</pre></div>
</div>
<p>How to exit the vision loop?  It could be based on time, or finding a
particular color, or finding a particular color 10 times in a row, or
finding only a particular color for 1 full second, or any other desired
criteria.</p>
</div>
</div>
</section>
<section id="advanced-use">
<h2>Advanced Use<a class="headerlink" href="#advanced-use" title="Permalink to this heading"></a></h2>
<p>Some teams may prefer to read and evaluate the <strong>actual RGB color values</strong>,
rather than rely on a generic Swatch result.</p>
<p>RGB is a <strong>Color Space</strong> that uses three numerical components of Red, Green and
Blue.  Values range from 0 to 255.  For more info, see this tutorial’s <a class="reference internal" href="../color-spaces/color-spaces.html"><span class="doc">Color
Spaces</span></a> page.</p>
<p>Extracting the RGB components can be seen in the Telemetry portion of the
Sample OpMode.  Click the Blocks or Java tab:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="a533135b-5a16-4e3b-b972-cbb23f485afd" name="19bc044e-fef5-4446-9da1-1c3e50f3d5b2" type="radio">
</input><label class="sd-tab-label" data-sync-id="blocks" for="a533135b-5a16-4e3b-b972-cbb23f485afd">
Blocks</label><div class="sd-tab-content docutils">
<p>Here are the RGB components of the ROI’s predominant color:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/70-Blocks-RGB.png"><img alt="Finding color by RGB" src="../../_images/70-Blocks-RGB.png" style="width: 75%;" /></a>
</figure>
<p>Note: the <code class="docutils literal notranslate"><span class="pre">Color</span></code> Block has a drop-down list that includes Hue,
Saturation and Value.  Those settings will <strong>not work</strong> here, to produce
components in the HSV Color Space, because the source Block provides only
RGB color (its method name is <code class="docutils literal notranslate"><span class="pre">.rgb</span></code>).</p>
</div>
<input id="a4d6007d-9ad9-4418-9231-1c0e6af4d6db" name="19bc044e-fef5-4446-9da1-1c3e50f3d5b2" type="radio">
</input><label class="sd-tab-label" data-sync-id="java" for="a4d6007d-9ad9-4418-9231-1c0e6af4d6db">
Java</label><div class="sd-tab-content docutils">
<p>Here are the RGB components of the ROI’s predominant color:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Color.red(result.rgb)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Color.green(result.rgb)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Color.blue(result.rgb)</span></code></p></li>
</ul>
</div>
</div>
<p>For Blocks or Java, those component values can be assigned to numeric
variables, with names like <code class="docutils literal notranslate"><span class="pre">ROIRedValue</span></code>, <code class="docutils literal notranslate"><span class="pre">ROIGreenValue</span></code>, and
<code class="docutils literal notranslate"><span class="pre">ROIBlueValue</span></code>.</p>
<p>Now your code can process those RGB variables as desired.</p>
</section>
<section id="next-sections">
<h2>Next Sections<a class="headerlink" href="#next-sections" title="Permalink to this heading"></a></h2>
<p>Soon you can move ahead to try the <strong>Color Locator</strong> processor.</p>
<p>But first, learn a few basic concepts at this tutorial’s <a class="reference internal" href="../color-blob-concepts/color-blob-concepts.html"><span class="doc">Color Blob Concepts</span></a> page.</p>
<hr class="docutils" />
<p><em>Questions, comments and corrections to westsiderobotics&#64;verizon.net</em></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Color Processing Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../color-blob-concepts/color-blob-concepts.html" class="btn btn-neutral float-right" title="Color Blob Concepts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo" style="display: flex">
  
    <div id="container" style="width: 50%; white-space:nowrap;">

      <div>
        &#169; 2025 <i>FIRST</i>
      </div>

      <div>
        <p><a href="../../tos/tos.html">Terms of Service</a></p>
      </div>
      <div>
        <p><a class="external" href="https://www.firstinspires.org/privacy-policy">Privacy Policy</a></p>
      </div>
      <div>
        <p><a class="external" href="https://www.firstinspires.org/programs/youth-protection-program">Report an Incident</a></p>
      </div>

      <div>
      </div>
    </div>

    <div align="right" style='flex-grow:1; text-align: right'>
      Season Presenting Sponsor
      <figure>
        <img src="../../_static/RTX.png" alt="RTX" class="invert-img" width="200" align="right"/>
      </figure>
    </div>
  </div>
<!--
  <div> 
  </div>
  -->
</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

</body>
</html>